# Soda v4 Contract: Sales Transform
# Validates the output of the sales transform pipeline

dataset: duckdb_check/sales_transform

columns:
  - name: sale_id
  - name: artwork_id
  - name: sale_date
  - name: sale_price_usd
    checks:
      - missing:
          must_be: 0
      - invalid:
          must_be: 0
          valid_min: 1
  - name: buyer_country
  - name: title
  - name: artist_id
  - name: artist_name
    checks:
      - missing:
          must_be: 0
  - name: list_price_usd
    checks:
      - missing:
          must_be: 0
      - invalid:
          must_be: 0
          valid_min: 1

checks:
  - row_count:
      must_be_greater_than: 0
  - duplicate:
      columns: [sale_id]
      must_be: 0
